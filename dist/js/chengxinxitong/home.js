$(document).ready(function(){init_banner(),init_msg(),init_digit(),$(".close_btn").on("tap",function(){$(".success_clock_in_msg").hide()}),post("http://s.chengxinxitong.com/app1.0.0/getUserInfoData.action",{identify:get_identify_safe()},function(resp){var resp=eval("("+resp+")");return 0!=resp.errno&&"error"in resp?(alert(resp.error),!1):void(0!=resp.sign_state&&$("#clock_in .app_title").html("已签到"))}),$("#clock_in").on("tap",function(){go_clock_in()})});var init_banner=function(){var slider=$("#carousel"),item_container=slider.children(".carousel-inner"),indicator_list=slider.children(".carousel-indicators");post("http://s.chengxinxitong.com/app1.0.0/getBannerListData.action",{identify:get_identify_safe()},function(resp){var resp=eval("("+resp+")");if(0==resp.errno){for(var idx=0;idx<resp.banner.length;idx++){var item=resp.banner[idx];item_container.append('<a target="_top" href="'+("url"in item?item.url:"#")+'" class="item'+(0==idx?" active":"")+'"><img src="'+item.image+'" alt="'+item.name+'" /></a>'),indicator_list.append('<li data-target="#'+slider.attr("id")+'" data-slide-to="'+idx+'" '+(0==idx?'class="active"':"")+"></li>")}slider.carousel({interval:!1}),init_slide_action(slider)}else alert(resp.error)})},init_slide_action=function(e){$(e.find(".item")).on("swipeleft",function(){e.carousel("next")}),$(e.find(".item")).on("swiperight",function(){e.carousel("prev")})},init_msg=function(){post("http://s.chengxinxitong.com/app1.0.0/getMessageNoReadCount.action",{identify:get_identify_safe()},function(resp){var resp=eval("("+resp+")");return 0!=resp.errno&&"error"in resp?(alert(resp.error),!1):void(resp.count>0&&$(".have_msg_point").show())})},go_clock_in=function(){post("http://s.chengxinxitong.com/app1.0.0/sendUserSign.action",{identify:get_identify_safe()},function(resp){var resp=eval("("+resp+")");return 0!=resp.errno&&"error"in resp?(alert(resp.error),!1):($(".income_box").text("激活 "+resp.money+" 个诚信币"),$(".msg_box").text(resp.message),void $(".success_clock_in_msg").show())})},init_digit=function(){post("http://s.chengxinxitong.com/app1.0.0/getUserInfoData.action",{identify:get_identify_safe()},function(resp){var resp=eval("("+resp+")");return 0!=resp.errno&&"error"in resp?(alert(resp.error),!1):(window.localStorage.logo=resp.logo,window.localStorage.name=resp.name,$('.app_container[role="family_account"] .app_hint').text(resp.family_money),$('.app_container[role="user_account"] .app_hint').text(resp.personal_money),$('.app_container[role="treasure"] .app_hint').text(resp.personal_today),void $('.app_container[role="clock_in"] .app_hint').text(resp.sign_money))})};