$(document).ready(function(){init_data(),choose_type_action(),choose_month_action()});var CURRENT_PAGE=1,TOTAL_PAGE=1,YEAR=(new Date).getFullYear(),MONTH=(new Date).getMonth()+1,init_data=function(){destroy_scrollers(),$(".list").html(""),get_data_from_server(YEAR,MONTH,CURRENT_PAGE,function(){init_scrollers(more_data)})},choose_month_action=function(){$(".header_right_btn").on("tap",function(){var e=prompt("请以yyyy mm的形式输入待查询月份："),t=e.split(" "),i=parseInt(t[0]),a=parseInt(t[1]);return 1>a||a>12||0>i?(alert("请输入正确的时间"),!1):i==YEAR&&a==MONTH?!1:(CURRENT_PAGE=1,TOTAL_PAGE=1,YEAR=i,MONTH=a,init_data(),!1)})},choose_type_action=function(){$(".nav_option").on("tap",function(){return $(this).hasClass("active")?!1:($(".nav_option.active").removeClass("active"),$(this).addClass("active"),CURRENT_PAGE=1,TOTAL_PAGE=1,void init_data())})},more_data=function(e){var t=CURRENT_PAGE+1;return t>TOTAL_PAGE?(alert("没有更多数据"),!1):void get_data_from_server(YEAR,MONTH,t,e)},ITEM_STR='<div class="item"><div class="item_line item_name_line"><div class="left_item textEllipsis">系统分配</div><div class="right_item textEllipsis">2017-02-11</div></div><div class="item_line item_balance_line"><div class="left_item textEllipsis">余额：856.25</div><div class="right_item textEllipsis">+200</div></div></div>',get_data_from_server=function(year,month,page,callback){var role=$(".list_box").attr("role"),itype=parseInt($(".nav_option.active").attr("value")),url="family"==role?"http://s.chengxinxitong.com/app1.0.0/getFamilyAccountListData.action":"http://s.chengxinxitong.com/app1.0.0/getPersonalAccountListData.action";post(url,{identify:get_identify_safe(),year:year,month:month,type:itype,page:page},function(resp){var resp=eval("("+resp+")");if(0!=resp.errno&&"error"in resp)return alert(resp.error),!1;TOTAL_PAGE=resp.page;for(var idx in resp.list){var item=resp.list[idx],new_item=$(ITEM_STR);new_item.children(".item_name_line").children(".left_item").text(item.name),new_item.children(".item_name_line").children(".right_item").text(item.time),new_item.children(".item_balance_line").children(".left_item").text(item.balance),new_item.children(".item_balance_line").children(".right_item").text((item.money>0?"+":"")+item.money),$(".list").append(new_item)}callback&&callback()})};